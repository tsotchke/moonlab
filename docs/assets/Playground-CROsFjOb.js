import{r as c,j as s}from"./index-BQkcNrQ4.js";import{e as L,r as q}from"./moonlabClient-D-rb-4O8.js";const f={H:{name:"Hadamard",description:"Creates superposition |0⟩→|+⟩, |1⟩→|-⟩",color:"#6496ff",category:"single"},X:{name:"Pauli-X",description:"Bit flip (NOT gate)",color:"#ff6666",category:"single"},Y:{name:"Pauli-Y",description:"Bit + phase flip",color:"#66cc66",category:"single"},Z:{name:"Pauli-Z",description:"Phase flip |1⟩→-|1⟩",color:"#ffcc44",category:"single"},S:{name:"S Gate",description:"Phase gate π/2 (√Z)",color:"#ff66ff",category:"single"},T:{name:"T Gate",description:"Phase gate π/4 (√S)",color:"#66ffff",category:"single"},Sdg:{name:"S†",description:"S-dagger (inverse S)",color:"#cc44cc",category:"single",symbol:"S†"},Tdg:{name:"T†",description:"T-dagger (inverse T)",color:"#44cccc",category:"single",symbol:"T†"},SX:{name:"√X",description:"Square root of X",color:"#ff8888",category:"single",symbol:"√X"},I:{name:"Identity",description:"Identity (no operation)",color:"#888888",category:"single"},Rx:{name:"Rx(θ)",description:"X-axis rotation",color:"#ff4444",category:"rotation",needsAngle:!0},Ry:{name:"Ry(θ)",description:"Y-axis rotation",color:"#44ff44",category:"rotation",needsAngle:!0},Rz:{name:"Rz(θ)",description:"Z-axis rotation",color:"#ffff44",category:"rotation",needsAngle:!0},P:{name:"Phase(θ)",description:"Phase rotation",color:"#ff88ff",category:"rotation",symbol:"P",needsAngle:!0},U:{name:"U Gate",description:"Universal single-qubit gate",color:"#8888ff",category:"rotation",needsAngle:!0},CNOT:{name:"CNOT",description:"Controlled-X (CX)",color:"#9966ff",category:"two-qubit",symbol:"CX",needsControl:!0},CY:{name:"CY",description:"Controlled-Y",color:"#66aa66",category:"two-qubit",needsControl:!0},CZ:{name:"CZ",description:"Controlled-Z",color:"#ff9966",category:"two-qubit",needsControl:!0},CH:{name:"CH",description:"Controlled-Hadamard",color:"#6699ff",category:"two-qubit",needsControl:!0},CP:{name:"CPhase",description:"Controlled-Phase",color:"#cc66ff",category:"two-qubit",needsControl:!0,needsAngle:!0},SWAP:{name:"SWAP",description:"Swap two qubits",color:"#66ff99",category:"two-qubit",symbol:"⨯"},iSWAP:{name:"iSWAP",description:"iSWAP gate",color:"#99ff66",category:"two-qubit",symbol:"i⨯"},DCX:{name:"DCX",description:"Double CNOT",color:"#aa66ff",category:"two-qubit"},CCX:{name:"Toffoli",description:"Controlled-Controlled-X (CCX)",color:"#ff66cc",category:"three-qubit",symbol:"CCX",needsTwoControls:!0},CCZ:{name:"CCZ",description:"Controlled-Controlled-Z",color:"#ffaa66",category:"three-qubit",needsTwoControls:!0},CSWAP:{name:"Fredkin",description:"Controlled-SWAP",color:"#66ffcc",category:"three-qubit",needsTwoControls:!0},M:{name:"Measure",description:"Measurement in Z basis",color:"#ffffff",category:"special",symbol:"M"},Reset:{name:"Reset",description:"Reset qubit to |0⟩",color:"#aaaaaa",category:"special",symbol:"|0⟩"},Barrier:{name:"Barrier",description:"Visual separator (no operation)",color:"#555555",category:"special",symbol:"│"}},Z=12,V=8,J={"Single Qubit":["H","X","Y","Z","S","T","Sdg","Tdg","SX","I"],Rotations:["Rx","Ry","Rz","P","U"],"Two Qubit":["CNOT","CY","CZ","CH","CP","SWAP","iSWAP","DCX"],"Three Qubit":["CCX","CCZ","CSWAP"],Special:["M","Reset","Barrier"]},K=(w,m,j)=>Math.min(Math.max(w,m),j),st=()=>{const w="./ml-logo.png",[m,j]=c.useState({numQubits:3,numSlots:Z,gates:[]}),[h,P]=c.useState([]),[i,T]=c.useState(null),[k,$]=c.useState(!1),[Q,G]=c.useState("Single Qubit"),[y,p]=c.useState("target"),[n,g]=c.useState(null),[N,W]=c.useState(Math.PI/2),[v,D]=c.useState(50),[H,B]=c.useState(40),X=c.useRef(null),R=c.useRef(null),I=c.useRef(null),M=c.useCallback((e,t)=>m.gates.find(o=>(o.qubit===e||o.controlQubit===e||o.controlQubit2===e||o.targetQubit===e)&&o.timeSlot===t),[m.gates]),z=e=>{const t=f[e];return t.needsControl||t.needsTwoControls||e==="SWAP"||e==="iSWAP"||e==="DCX"},E=c.useCallback((e,t)=>{if(!i)return;const o=f[i],a=M(e,t);if(a&&!n){j(r=>({...r,gates:r.gates.filter(u=>u.id!==a.id)}));return}if(z(i)){if(o.needsTwoControls){if(y==="control1"){g({timeSlot:t,controlQubit:e}),p("control2");return}else if(y==="control2"&&n){if(e===n.controlQubit)return;g({...n,controlQubit2:e}),p("target");return}else if(y==="target"&&(n==null?void 0:n.controlQubit)!==void 0&&(n==null?void 0:n.controlQubit2)!==void 0){if(e===n.controlQubit||e===n.controlQubit2)return;const r={id:`gate-${Date.now()}-${Math.random()}`,type:i,qubit:e,timeSlot:n.timeSlot,controlQubit:n.controlQubit,controlQubit2:n.controlQubit2,angle:o.needsAngle?N:void 0};j(u=>({...u,gates:[...u.gates,r]})),g(null),p("control1");return}}else if(o.needsControl||i==="SWAP"||i==="iSWAP"||i==="DCX"){if(y==="control1"){g({timeSlot:t,controlQubit:e}),p("target");return}else if(y==="target"&&(n==null?void 0:n.controlQubit)!==void 0){if(e===n.controlQubit)return;const r={id:`gate-${Date.now()}-${Math.random()}`,type:i,qubit:e,timeSlot:n.timeSlot,controlQubit:n.controlQubit,angle:o.needsAngle?N:void 0};j(u=>({...u,gates:[...u.gates,r]})),g(null),p("control1");return}}}if(z(i)){g({timeSlot:t}),p((o.needsTwoControls,"control1")),E(e,t);return}const l={id:`gate-${Date.now()}-${Math.random()}`,type:i,qubit:e,timeSlot:t,angle:o.needsAngle?N:void 0};j(r=>({...r,gates:[...r.gates,l]}))},[i,M,n,y,N]),O=c.useCallback(()=>{j(e=>({...e,gates:[]})),P([]),g(null),p("control1")},[]),Y=c.useCallback(e=>{j({numQubits:e,numSlots:Z,gates:[]}),P([]),g(null)},[]),_=c.useCallback(e=>{i===e?(T(null),g(null),p("control1")):(T(e),g(null),p(f[e].needsTwoControls||f[e].needsControl||e==="SWAP"||e==="iSWAP"||e==="DCX"?"control1":"target"))},[i]),F=c.useCallback(async()=>{$(!0);try{await L();const t=[...m.gates].sort((a,l)=>a.timeSlot-l.timeSlot).map(a=>({type:a.type,qubit:a.qubit,controlQubit:a.controlQubit,controlQubit2:a.controlQubit2,angle:a.angle})),o=await q({numQubits:m.numQubits,gates:t});o.warnings.length&&console.warn("Playground gate warnings:",o.warnings),P(Array.from(o.probabilities))}catch(e){console.error("Failed to simulate circuit",e),P([])}finally{$(!1)}},[m]);c.useEffect(()=>{const e=R.current;if(!e)return;const t=e.getContext("2d");if(!t)return;const o=e.width,a=e.height;if(t.fillStyle="#0d0d1a",t.fillRect(0,0,o,a),h.length===0){t.fillStyle="#404060",t.font="14px sans-serif",t.textAlign="center",t.fillText('Click "Simulate" to see results',o/2,a/2);return}const l=Math.max(4,(o-40)/h.length-2),r=a-60;h.forEach((u,b)=>{const d=20+b*(l+2),C=u*r,x=a-30-C,S=t.createLinearGradient(d,x+C,d,x);if(S.addColorStop(0,"#6496ff"),S.addColorStop(1,"#9966ff"),t.fillStyle=S,t.fillRect(d,x,l,C),h.length<=16){t.fillStyle="#606080",t.font="10px monospace",t.textAlign="center";const A=b.toString(2).padStart(m.numQubits,"0");t.fillText(`|${A}⟩`,d+l/2,a-10)}}),t.strokeStyle="#303050",t.lineWidth=1,t.beginPath(),t.moveTo(15,20),t.lineTo(15,a-30),t.stroke(),t.fillStyle="#606080",t.font="10px sans-serif",t.textAlign="right",t.fillText("1.0",12,25),t.fillText("0.5",12,a/2),t.fillText("0.0",12,a-32)},[h,m.numQubits]),c.useEffect(()=>{const e=I.current;if(!e)return;const t=e.getContext("2d");if(!t)return;const o=e.width,a=e.height,l=o/2,r=a/2,u=Math.min(o,a)/2-30;t.fillStyle="#0d0d1a",t.fillRect(0,0,o,a),t.strokeStyle="rgba(100, 150, 255, 0.3)",t.lineWidth=2,t.beginPath(),t.arc(l,r,u,0,Math.PI*2),t.stroke();const b=(d,C,x)=>{const S=l+Math.cos(d)*u,A=r+Math.sin(d)*u;t.strokeStyle=x,t.lineWidth=1,t.beginPath(),t.moveTo(l,r),t.lineTo(S,A),t.stroke(),t.fillStyle=x,t.font="12px sans-serif",t.textAlign="center",t.fillText(C,S+Math.cos(d)*15,A+Math.sin(d)*15+4)};if(b(-Math.PI/2,"|0⟩","#00ff88"),b(Math.PI/2,"|1⟩","#ff6688"),b(0,"+X","#6496ff"),b(Math.PI,"-X","#6496ff"),h.length===2){const d=Math.acos(Math.sqrt(h[0]))*2,C=l+Math.sin(d)*u*.9,x=r-Math.cos(d)*u*.9;t.strokeStyle="#ffcc00",t.lineWidth=3,t.beginPath(),t.moveTo(l,r),t.lineTo(C,x),t.stroke(),t.fillStyle="#ffcc00",t.beginPath(),t.arc(C,x,6,0,Math.PI*2),t.fill()}},[h]),c.useEffect(()=>{const e=()=>{const t=X.current;if(!t)return;const o=t.clientWidth,a=o<480?32:40,l=32,r=o>=900?28:36,u=Math.max(0,o-l-a*2),b=Math.floor(u/m.numSlots),d=K(b,r,50);B(a),D(d)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[m.numSlots]);const U=()=>{if(!i)return"Select a gate from the palette";const e=f[i];return e.needsTwoControls?y==="control1"?`Click to place first control for ${e.name}`:y==="control2"?`Click to place second control for ${e.name}`:`Click to place target for ${e.name}`:e.needsControl||i==="SWAP"||i==="iSWAP"||i==="DCX"?y==="control1"?`Click to place ${i==="SWAP"||i==="iSWAP"?"first qubit":"control"} for ${e.name}`:`Click to place ${i==="SWAP"||i==="iSWAP"?"second qubit":"target"} for ${e.name}`:`Click to place ${e.name}`};return s.jsxs("div",{className:"playground",children:[s.jsxs("div",{className:"section-header",children:[s.jsx("img",{className:"section-logo",src:w,alt:"","aria-hidden":"true"}),s.jsxs("div",{className:"section-header-text",children:[s.jsx("h1",{className:"section-title",children:"Quantum Circuit Playground"}),s.jsx("p",{className:"section-description",children:"Build quantum circuits interactively. Select a gate, then click on the circuit grid to place it."})]})]}),s.jsxs("div",{className:"playground-layout",children:[s.jsxs("div",{className:"gate-palette",children:[s.jsx("h3",{className:"palette-title",children:"Gates"}),Object.entries(J).map(([e,t])=>s.jsxs("div",{className:"gate-category",children:[s.jsxs("button",{className:`category-header ${Q===e?"expanded":""}`,onClick:()=>G(Q===e?"":e),children:[s.jsx("span",{children:e}),s.jsx("span",{className:"category-arrow",children:Q===e?"▼":"▶"})]}),Q===e&&s.jsx("div",{className:"gate-grid",children:t.map(o=>s.jsxs("button",{className:`gate-btn ${i===o?"selected":""}`,style:{borderColor:f[o].color},onClick:()=>_(o),title:f[o].description,children:[s.jsx("span",{className:"gate-symbol",style:{color:f[o].color},children:f[o].symbol||o}),s.jsx("span",{className:"gate-name",children:f[o].name})]},o))})]},e)),i&&f[i].needsAngle&&s.jsxs("div",{className:"palette-section",children:[s.jsx("h4",{children:"Rotation Angle"}),s.jsxs("div",{className:"angle-control",children:[s.jsx("input",{type:"range",min:"0",max:2*Math.PI,step:Math.PI/8,value:N,onChange:e=>W(parseFloat(e.target.value))}),s.jsxs("span",{className:"angle-value",children:[(N/Math.PI).toFixed(2),"π"]})]}),s.jsx("div",{className:"angle-presets",children:[["π/4",Math.PI/4],["π/2",Math.PI/2],["π",Math.PI],["3π/2",3*Math.PI/2]].map(([e,t])=>s.jsx("button",{className:`angle-preset ${Math.abs(N-t)<.01?"selected":""}`,onClick:()=>W(t),children:e},e))})]}),s.jsxs("div",{className:"palette-section",children:[s.jsxs("h4",{children:["Qubits (",m.numQubits,")"]}),s.jsx("div",{className:"qubit-selector",children:Array.from({length:V},(e,t)=>t+1).map(e=>s.jsx("button",{className:`qubit-btn ${m.numQubits===e?"selected":""}`,onClick:()=>Y(e),children:e},e))})]}),s.jsxs("div",{className:"palette-actions",children:[s.jsx("button",{className:"btn btn-primary",onClick:F,disabled:k,children:k?"Simulating...":"Simulate"}),s.jsx("button",{className:"btn btn-secondary",onClick:O,children:"Clear"})]})]}),s.jsxs("div",{className:"circuit-editor",children:[s.jsx("h3",{children:"Circuit"}),s.jsx("div",{className:"circuit-scroll",ref:X,children:s.jsxs("div",{className:"circuit-grid-container",style:{"--slot-size":`${v}px`,"--label-size":`${H}px`},children:[s.jsxs("div",{className:"time-slot-header",children:[s.jsx("div",{className:"qubit-label-spacer"}),Array.from({length:m.numSlots},(e,t)=>s.jsxs("div",{className:"time-slot-label",children:["t",t]},t)),s.jsx("div",{className:"measurement-spacer"})]}),Array.from({length:m.numQubits},(e,t)=>s.jsxs("div",{className:"qubit-row",children:[s.jsxs("span",{className:"qubit-label",children:["q",t]}),s.jsx("div",{className:"wire-grid",children:Array.from({length:m.numSlots},(o,a)=>{const l=M(t,a),r=(n==null?void 0:n.timeSlot)===a,u=(n==null?void 0:n.controlQubit)===t&&r,b=(n==null?void 0:n.controlQubit2)===t&&r,d=m.gates.find(S=>S.timeSlot===a&&(S.controlQubit===t||S.controlQubit2===t)),C=!!d&&(d.controlQubit===t||d.controlQubit2===t),x=()=>u||b?s.jsx("div",{className:"control-node pending",title:"Control qubit (pending)",children:"●"}):C&&d?s.jsx("div",{className:"control-node",style:{color:f[d.type].color},title:`Control for ${d.type}`,children:"●"}):l&&l.qubit===t?s.jsx("div",{className:`gate-on-grid ${l.type==="Barrier"?"barrier":""}`,style:{backgroundColor:f[l.type].color},title:`${f[l.type].name}${l.angle?` (${(l.angle/Math.PI).toFixed(2)}π)`:""}`,children:f[l.type].symbol||l.type}):null;return s.jsxs("div",{className:`grid-cell ${i?"clickable":""} ${l?"has-gate":""} ${r?"pending-slot":""}`,onClick:()=>E(t,a),children:[s.jsx("div",{className:"wire-segment"}),x(),l&&l.qubit===t&&l.controlQubit!==void 0&&s.jsx("div",{className:"gate-connection",style:{height:`${Math.abs(l.controlQubit-t)*v}px`,top:l.controlQubit<t?`${(l.controlQubit-t)*v+v/2}px`:`${v/2}px`,borderColor:f[l.type].color}})]},a)})}),s.jsx("span",{className:"measurement",children:"M"})]},t))]})}),s.jsx("p",{className:`hint ${n?"pending":""}`,children:U()}),n&&s.jsx("button",{className:"btn btn-cancel",onClick:()=>{g(null),p("control1")},children:"Cancel Placement"})]}),s.jsxs("div",{className:"visualization-panel",children:[s.jsxs("div",{className:"viz-card",children:[s.jsx("h3",{children:"Probability Amplitudes"}),s.jsx("canvas",{ref:R,width:400,height:200,className:"viz-canvas"})]}),m.numQubits===1&&s.jsxs("div",{className:"viz-card",children:[s.jsx("h3",{children:"Bloch Sphere"}),s.jsx("canvas",{ref:I,width:200,height:200,className:"viz-canvas"})]}),h.length>0&&s.jsxs("div",{className:"viz-card stats-card",children:[s.jsx("h3",{children:"Statistics"}),s.jsxs("div",{className:"stats-grid",children:[s.jsxs("div",{className:"stat",children:[s.jsx("span",{className:"stat-label",children:"States"}),s.jsx("span",{className:"stat-value",children:h.length})]}),s.jsxs("div",{className:"stat",children:[s.jsx("span",{className:"stat-label",children:"Non-zero"}),s.jsx("span",{className:"stat-value",children:h.filter(e=>e>.001).length})]}),s.jsxs("div",{className:"stat",children:[s.jsx("span",{className:"stat-label",children:"Max Prob"}),s.jsxs("span",{className:"stat-value",children:[(Math.max(...h)*100).toFixed(1),"%"]})]})]})]})]})]})]})};export{st as default};
//# sourceMappingURL=Playground-CROsFjOb.js.map
