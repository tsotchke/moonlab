import{r as d,j as o}from"./index-DChC9JkI.js";import{e as O,r as Y}from"./moonlabClient-D-rb-4O8.js";const m={H:{name:"Hadamard",description:"Creates superposition |0⟩→|+⟩, |1⟩→|-⟩",color:"#6496ff",category:"single"},X:{name:"Pauli-X",description:"Bit flip (NOT gate)",color:"#ff6666",category:"single"},Y:{name:"Pauli-Y",description:"Bit + phase flip",color:"#66cc66",category:"single"},Z:{name:"Pauli-Z",description:"Phase flip |1⟩→-|1⟩",color:"#ffcc44",category:"single"},S:{name:"S Gate",description:"Phase gate π/2 (√Z)",color:"#ff66ff",category:"single"},T:{name:"T Gate",description:"Phase gate π/4 (√S)",color:"#66ffff",category:"single"},Sdg:{name:"S†",description:"S-dagger (inverse S)",color:"#cc44cc",category:"single",symbol:"S†"},Tdg:{name:"T†",description:"T-dagger (inverse T)",color:"#44cccc",category:"single",symbol:"T†"},SX:{name:"√X",description:"Square root of X",color:"#ff8888",category:"single",symbol:"√X"},I:{name:"Identity",description:"Identity (no operation)",color:"#888888",category:"single"},Rx:{name:"Rx(θ)",description:"X-axis rotation",color:"#ff4444",category:"rotation",needsAngle:!0},Ry:{name:"Ry(θ)",description:"Y-axis rotation",color:"#44ff44",category:"rotation",needsAngle:!0},Rz:{name:"Rz(θ)",description:"Z-axis rotation",color:"#ffff44",category:"rotation",needsAngle:!0},P:{name:"Phase(θ)",description:"Phase rotation",color:"#ff88ff",category:"rotation",symbol:"P",needsAngle:!0},U:{name:"U Gate",description:"Universal single-qubit gate",color:"#8888ff",category:"rotation",needsAngle:!0},CNOT:{name:"CNOT",description:"Controlled-X (CX)",color:"#9966ff",category:"two-qubit",symbol:"CX",needsControl:!0},CY:{name:"CY",description:"Controlled-Y",color:"#66aa66",category:"two-qubit",needsControl:!0},CZ:{name:"CZ",description:"Controlled-Z",color:"#ff9966",category:"two-qubit",needsControl:!0},CH:{name:"CH",description:"Controlled-Hadamard",color:"#6699ff",category:"two-qubit",needsControl:!0},CP:{name:"CPhase",description:"Controlled-Phase",color:"#cc66ff",category:"two-qubit",needsControl:!0,needsAngle:!0},SWAP:{name:"SWAP",description:"Swap two qubits",color:"#66ff99",category:"two-qubit",symbol:"⨯"},iSWAP:{name:"iSWAP",description:"iSWAP gate",color:"#99ff66",category:"two-qubit",symbol:"i⨯"},DCX:{name:"DCX",description:"Double CNOT",color:"#aa66ff",category:"two-qubit"},CCX:{name:"Toffoli",description:"Controlled-Controlled-X (CCX)",color:"#ff66cc",category:"three-qubit",symbol:"CCX",needsTwoControls:!0},CCZ:{name:"CCZ",description:"Controlled-Controlled-Z",color:"#ffaa66",category:"three-qubit",needsTwoControls:!0},CSWAP:{name:"Fredkin",description:"Controlled-SWAP",color:"#66ffcc",category:"three-qubit",needsTwoControls:!0},M:{name:"Measure",description:"Measurement in Z basis",color:"#ffffff",category:"special",symbol:"M"},Reset:{name:"Reset",description:"Reset qubit to |0⟩",color:"#aaaaaa",category:"special",symbol:"|0⟩"},Barrier:{name:"Barrier",description:"Visual separator (no operation)",color:"#555555",category:"special",symbol:"│"}},R=12,_=8,F={"Single Qubit":["H","X","Y","Z","S","T","Sdg","Tdg","SX","I"],Rotations:["Rx","Ry","Rz","P","U"],"Two Qubit":["CNOT","CY","CZ","CH","CP","SWAP","iSWAP","DCX"],"Three Qubit":["CCX","CCZ","CSWAP"],Special:["M","Reset","Barrier"]},L=()=>{const Z="./moonlab.png",[f,N]=d.useState({numQubits:3,numSlots:R,gates:[]}),[h,P]=d.useState([]),[r,M]=d.useState(null),[w,T]=d.useState(!1),[v,G]=d.useState("Single Qubit"),[y,x]=d.useState("target"),[n,g]=d.useState(null),[j,k]=d.useState(Math.PI/2),$=d.useRef(null),W=d.useRef(null),A=d.useCallback((e,t)=>f.gates.find(s=>(s.qubit===e||s.controlQubit===e||s.controlQubit2===e||s.targetQubit===e)&&s.timeSlot===t),[f.gates]),X=e=>{const t=m[e];return t.needsControl||t.needsTwoControls||e==="SWAP"||e==="iSWAP"||e==="DCX"},I=d.useCallback((e,t)=>{if(!r)return;const s=m[r],a=A(e,t);if(a&&!n){N(i=>({...i,gates:i.gates.filter(u=>u.id!==a.id)}));return}if(X(r)){if(s.needsTwoControls){if(y==="control1"){g({timeSlot:t,controlQubit:e}),x("control2");return}else if(y==="control2"&&n){if(e===n.controlQubit)return;g({...n,controlQubit2:e}),x("target");return}else if(y==="target"&&(n==null?void 0:n.controlQubit)!==void 0&&(n==null?void 0:n.controlQubit2)!==void 0){if(e===n.controlQubit||e===n.controlQubit2)return;const i={id:`gate-${Date.now()}-${Math.random()}`,type:r,qubit:e,timeSlot:n.timeSlot,controlQubit:n.controlQubit,controlQubit2:n.controlQubit2,angle:s.needsAngle?j:void 0};N(u=>({...u,gates:[...u.gates,i]})),g(null),x("control1");return}}else if(s.needsControl||r==="SWAP"||r==="iSWAP"||r==="DCX"){if(y==="control1"){g({timeSlot:t,controlQubit:e}),x("target");return}else if(y==="target"&&(n==null?void 0:n.controlQubit)!==void 0){if(e===n.controlQubit)return;const i={id:`gate-${Date.now()}-${Math.random()}`,type:r,qubit:e,timeSlot:n.timeSlot,controlQubit:n.controlQubit,angle:s.needsAngle?j:void 0};N(u=>({...u,gates:[...u.gates,i]})),g(null),x("control1");return}}}if(X(r)){g({timeSlot:t}),x((s.needsTwoControls,"control1")),I(e,t);return}const l={id:`gate-${Date.now()}-${Math.random()}`,type:r,qubit:e,timeSlot:t,angle:s.needsAngle?j:void 0};N(i=>({...i,gates:[...i.gates,l]}))},[r,A,n,y,j]),D=d.useCallback(()=>{N(e=>({...e,gates:[]})),P([]),g(null),x("control1")},[]),E=d.useCallback(e=>{N({numQubits:e,numSlots:R,gates:[]}),P([]),g(null)},[]),z=d.useCallback(e=>{r===e?(M(null),g(null),x("control1")):(M(e),g(null),x(m[e].needsTwoControls||m[e].needsControl||e==="SWAP"||e==="iSWAP"||e==="DCX"?"control1":"target"))},[r]),H=d.useCallback(async()=>{T(!0);try{await O();const t=[...f.gates].sort((a,l)=>a.timeSlot-l.timeSlot).map(a=>({type:a.type,qubit:a.qubit,controlQubit:a.controlQubit,controlQubit2:a.controlQubit2,angle:a.angle})),s=await Y({numQubits:f.numQubits,gates:t});s.warnings.length&&console.warn("Playground gate warnings:",s.warnings),P(Array.from(s.probabilities))}catch(e){console.error("Failed to simulate circuit",e),P([])}finally{T(!1)}},[f]);d.useEffect(()=>{const e=$.current;if(!e)return;const t=e.getContext("2d");if(!t)return;const s=e.width,a=e.height;if(t.fillStyle="#0d0d1a",t.fillRect(0,0,s,a),h.length===0){t.fillStyle="#404060",t.font="14px sans-serif",t.textAlign="center",t.fillText('Click "Simulate" to see results',s/2,a/2);return}const l=Math.max(4,(s-40)/h.length-2),i=a-60;h.forEach((u,S)=>{const c=20+S*(l+2),C=u*i,b=a-30-C,p=t.createLinearGradient(c,b+C,c,b);if(p.addColorStop(0,"#6496ff"),p.addColorStop(1,"#9966ff"),t.fillStyle=p,t.fillRect(c,b,l,C),h.length<=16){t.fillStyle="#606080",t.font="10px monospace",t.textAlign="center";const Q=S.toString(2).padStart(f.numQubits,"0");t.fillText(`|${Q}⟩`,c+l/2,a-10)}}),t.strokeStyle="#303050",t.lineWidth=1,t.beginPath(),t.moveTo(15,20),t.lineTo(15,a-30),t.stroke(),t.fillStyle="#606080",t.font="10px sans-serif",t.textAlign="right",t.fillText("1.0",12,25),t.fillText("0.5",12,a/2),t.fillText("0.0",12,a-32)},[h,f.numQubits]),d.useEffect(()=>{const e=W.current;if(!e)return;const t=e.getContext("2d");if(!t)return;const s=e.width,a=e.height,l=s/2,i=a/2,u=Math.min(s,a)/2-30;t.fillStyle="#0d0d1a",t.fillRect(0,0,s,a),t.strokeStyle="rgba(100, 150, 255, 0.3)",t.lineWidth=2,t.beginPath(),t.arc(l,i,u,0,Math.PI*2),t.stroke();const S=(c,C,b)=>{const p=l+Math.cos(c)*u,Q=i+Math.sin(c)*u;t.strokeStyle=b,t.lineWidth=1,t.beginPath(),t.moveTo(l,i),t.lineTo(p,Q),t.stroke(),t.fillStyle=b,t.font="12px sans-serif",t.textAlign="center",t.fillText(C,p+Math.cos(c)*15,Q+Math.sin(c)*15+4)};if(S(-Math.PI/2,"|0⟩","#00ff88"),S(Math.PI/2,"|1⟩","#ff6688"),S(0,"+X","#6496ff"),S(Math.PI,"-X","#6496ff"),h.length===2){const c=Math.acos(Math.sqrt(h[0]))*2,C=l+Math.sin(c)*u*.9,b=i-Math.cos(c)*u*.9;t.strokeStyle="#ffcc00",t.lineWidth=3,t.beginPath(),t.moveTo(l,i),t.lineTo(C,b),t.stroke(),t.fillStyle="#ffcc00",t.beginPath(),t.arc(C,b,6,0,Math.PI*2),t.fill()}},[h]);const B=()=>{if(!r)return"Select a gate from the palette";const e=m[r];return e.needsTwoControls?y==="control1"?`Click to place first control for ${e.name}`:y==="control2"?`Click to place second control for ${e.name}`:`Click to place target for ${e.name}`:e.needsControl||r==="SWAP"||r==="iSWAP"||r==="DCX"?y==="control1"?`Click to place ${r==="SWAP"||r==="iSWAP"?"first qubit":"control"} for ${e.name}`:`Click to place ${r==="SWAP"||r==="iSWAP"?"second qubit":"target"} for ${e.name}`:`Click to place ${e.name}`};return o.jsxs("div",{className:"playground",children:[o.jsxs("div",{className:"section-header",children:[o.jsx("img",{className:"section-logo",src:Z,alt:"","aria-hidden":"true"}),o.jsxs("div",{className:"section-header-text",children:[o.jsx("h1",{className:"section-title",children:"Quantum Circuit Playground"}),o.jsx("p",{className:"section-description",children:"Build quantum circuits interactively. Select a gate, then click on the circuit grid to place it."})]})]}),o.jsxs("div",{className:"playground-layout",children:[o.jsxs("div",{className:"gate-palette",children:[o.jsx("h3",{className:"palette-title",children:"Gates"}),Object.entries(F).map(([e,t])=>o.jsxs("div",{className:"gate-category",children:[o.jsxs("button",{className:`category-header ${v===e?"expanded":""}`,onClick:()=>G(v===e?"":e),children:[o.jsx("span",{children:e}),o.jsx("span",{className:"category-arrow",children:v===e?"▼":"▶"})]}),v===e&&o.jsx("div",{className:"gate-grid",children:t.map(s=>o.jsxs("button",{className:`gate-btn ${r===s?"selected":""}`,style:{borderColor:m[s].color},onClick:()=>z(s),title:m[s].description,children:[o.jsx("span",{className:"gate-symbol",style:{color:m[s].color},children:m[s].symbol||s}),o.jsx("span",{className:"gate-name",children:m[s].name})]},s))})]},e)),r&&m[r].needsAngle&&o.jsxs("div",{className:"palette-section",children:[o.jsx("h4",{children:"Rotation Angle"}),o.jsxs("div",{className:"angle-control",children:[o.jsx("input",{type:"range",min:"0",max:2*Math.PI,step:Math.PI/8,value:j,onChange:e=>k(parseFloat(e.target.value))}),o.jsxs("span",{className:"angle-value",children:[(j/Math.PI).toFixed(2),"π"]})]}),o.jsx("div",{className:"angle-presets",children:[["π/4",Math.PI/4],["π/2",Math.PI/2],["π",Math.PI],["3π/2",3*Math.PI/2]].map(([e,t])=>o.jsx("button",{className:`angle-preset ${Math.abs(j-t)<.01?"selected":""}`,onClick:()=>k(t),children:e},e))})]}),o.jsxs("div",{className:"palette-section",children:[o.jsxs("h4",{children:["Qubits (",f.numQubits,")"]}),o.jsx("div",{className:"qubit-selector",children:Array.from({length:_},(e,t)=>t+1).map(e=>o.jsx("button",{className:`qubit-btn ${f.numQubits===e?"selected":""}`,onClick:()=>E(e),children:e},e))})]}),o.jsxs("div",{className:"palette-actions",children:[o.jsx("button",{className:"btn btn-primary",onClick:H,disabled:w,children:w?"Simulating...":"Simulate"}),o.jsx("button",{className:"btn btn-secondary",onClick:D,children:"Clear"})]})]}),o.jsxs("div",{className:"circuit-editor",children:[o.jsx("h3",{children:"Circuit"}),o.jsxs("div",{className:"circuit-grid-container",children:[o.jsxs("div",{className:"time-slot-header",children:[o.jsx("div",{className:"qubit-label-spacer"}),Array.from({length:f.numSlots},(e,t)=>o.jsxs("div",{className:"time-slot-label",children:["t",t]},t)),o.jsx("div",{className:"measurement-spacer"})]}),Array.from({length:f.numQubits},(e,t)=>o.jsxs("div",{className:"qubit-row",children:[o.jsxs("span",{className:"qubit-label",children:["q",t]}),o.jsx("div",{className:"wire-grid",children:Array.from({length:f.numSlots},(s,a)=>{const l=A(t,a),i=(n==null?void 0:n.timeSlot)===a,u=(n==null?void 0:n.controlQubit)===t&&i,S=(n==null?void 0:n.controlQubit2)===t&&i,c=f.gates.find(p=>p.timeSlot===a&&(p.controlQubit===t||p.controlQubit2===t)),C=!!c&&(c.controlQubit===t||c.controlQubit2===t),b=()=>u||S?o.jsx("div",{className:"control-node pending",title:"Control qubit (pending)",children:"●"}):C&&c?o.jsx("div",{className:"control-node",style:{color:m[c.type].color},title:`Control for ${c.type}`,children:"●"}):l&&l.qubit===t?o.jsx("div",{className:`gate-on-grid ${l.type==="Barrier"?"barrier":""}`,style:{backgroundColor:m[l.type].color},title:`${m[l.type].name}${l.angle?` (${(l.angle/Math.PI).toFixed(2)}π)`:""}`,children:m[l.type].symbol||l.type}):null;return o.jsxs("div",{className:`grid-cell ${r?"clickable":""} ${l?"has-gate":""} ${i?"pending-slot":""}`,onClick:()=>I(t,a),children:[o.jsx("div",{className:"wire-segment"}),b(),l&&l.qubit===t&&l.controlQubit!==void 0&&o.jsx("div",{className:"gate-connection",style:{height:`${Math.abs(l.controlQubit-t)*50}px`,top:l.controlQubit<t?`${(l.controlQubit-t)*50+25}px`:"25px",borderColor:m[l.type].color}})]},a)})}),o.jsx("span",{className:"measurement",children:"M"})]},t))]}),o.jsx("p",{className:`hint ${n?"pending":""}`,children:B()}),n&&o.jsx("button",{className:"btn btn-cancel",onClick:()=>{g(null),x("control1")},children:"Cancel Placement"})]}),o.jsxs("div",{className:"visualization-panel",children:[o.jsxs("div",{className:"viz-card",children:[o.jsx("h3",{children:"Probability Amplitudes"}),o.jsx("canvas",{ref:$,width:400,height:200,className:"viz-canvas"})]}),f.numQubits===1&&o.jsxs("div",{className:"viz-card",children:[o.jsx("h3",{children:"Bloch Sphere"}),o.jsx("canvas",{ref:W,width:200,height:200,className:"viz-canvas"})]}),h.length>0&&o.jsxs("div",{className:"viz-card stats-card",children:[o.jsx("h3",{children:"Statistics"}),o.jsxs("div",{className:"stats-grid",children:[o.jsxs("div",{className:"stat",children:[o.jsx("span",{className:"stat-label",children:"States"}),o.jsx("span",{className:"stat-value",children:h.length})]}),o.jsxs("div",{className:"stat",children:[o.jsx("span",{className:"stat-label",children:"Non-zero"}),o.jsx("span",{className:"stat-value",children:h.filter(e=>e>.001).length})]}),o.jsxs("div",{className:"stat",children:[o.jsx("span",{className:"stat-label",children:"Max Prob"}),o.jsxs("span",{className:"stat-value",children:[(Math.max(...h)*100).toFixed(1),"%"]})]})]})]})]})]})]})};export{L as default};
//# sourceMappingURL=Playground-D80JRgzL.js.map
