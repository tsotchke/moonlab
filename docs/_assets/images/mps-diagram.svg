<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 450">
  <defs>
    <linearGradient id="tensorGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#8b5cf6;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#7c3aed;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="bondGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#06b6d4;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#0891b2;stop-opacity:1" />
    </linearGradient>
  </defs>

  <!-- Title -->
  <text x="400" y="30" text-anchor="middle" font-family="system-ui, sans-serif" font-size="18" font-weight="bold" fill="#1f2937">Matrix Product State (MPS) Structure</text>

  <!-- Full state vector representation -->
  <g transform="translate(50, 60)">
    <text x="350" y="15" text-anchor="middle" font-family="system-ui, sans-serif" font-size="14" font-weight="bold" fill="#374151">Full State Vector (2^n amplitudes)</text>

    <rect x="100" y="30" width="500" height="50" rx="5" fill="#fee2e2" stroke="#ef4444" stroke-width="2"/>
    <text x="350" y="60" text-anchor="middle" font-family="system-ui, sans-serif" font-size="12" fill="#991b1b">ψ_{i₁i₂i₃...iₙ} = Σ c_{i₁i₂i₃...iₙ} |i₁i₂i₃...iₙ⟩</text>
    <text x="350" y="95" text-anchor="middle" font-family="system-ui, sans-serif" font-size="11" fill="#6b7280">Exponential memory: O(2ⁿ) complex amplitudes</text>
  </g>

  <!-- Arrow down -->
  <path d="M400 165 L400 185" stroke="#374151" stroke-width="2" marker-end="url(#arrowDown)"/>
  <defs>
    <marker id="arrowDown" markerWidth="10" markerHeight="7" refX="5" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#374151"/>
    </marker>
  </defs>
  <text x="415" y="180" font-family="system-ui, sans-serif" font-size="10" fill="#6b7280">SVD decomposition</text>

  <!-- MPS Representation -->
  <g transform="translate(50, 200)">
    <text x="350" y="15" text-anchor="middle" font-family="system-ui, sans-serif" font-size="14" font-weight="bold" fill="#374151">Matrix Product State Factorization</text>

    <!-- Site tensors -->
    <g transform="translate(80, 40)">
      <!-- Tensor A[1] -->
      <rect x="0" y="30" width="50" height="50" rx="8" fill="url(#tensorGrad)" stroke="#6d28d9" stroke-width="2"/>
      <text x="25" y="60" text-anchor="middle" font-family="system-ui, sans-serif" font-size="14" font-weight="bold" fill="white">A¹</text>
      <!-- Physical index -->
      <line x1="25" y1="30" x2="25" y2="5" stroke="#ef4444" stroke-width="3"/>
      <circle cx="25" cy="5" r="4" fill="#ef4444"/>
      <text x="25" y="-5" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" fill="#ef4444">i₁</text>
      <!-- Right bond -->
      <line x1="50" y1="55" x2="90" y2="55" stroke="url(#bondGrad)" stroke-width="4"/>
    </g>

    <!-- Tensor A[2] -->
    <g transform="translate(170, 40)">
      <rect x="0" y="30" width="50" height="50" rx="8" fill="url(#tensorGrad)" stroke="#6d28d9" stroke-width="2"/>
      <text x="25" y="60" text-anchor="middle" font-family="system-ui, sans-serif" font-size="14" font-weight="bold" fill="white">A²</text>
      <line x1="25" y1="30" x2="25" y2="5" stroke="#ef4444" stroke-width="3"/>
      <circle cx="25" cy="5" r="4" fill="#ef4444"/>
      <text x="25" y="-5" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" fill="#ef4444">i₂</text>
      <line x1="50" y1="55" x2="90" y2="55" stroke="url(#bondGrad)" stroke-width="4"/>
    </g>

    <!-- Tensor A[3] -->
    <g transform="translate(260, 40)">
      <rect x="0" y="30" width="50" height="50" rx="8" fill="url(#tensorGrad)" stroke="#6d28d9" stroke-width="2"/>
      <text x="25" y="60" text-anchor="middle" font-family="system-ui, sans-serif" font-size="14" font-weight="bold" fill="white">A³</text>
      <line x1="25" y1="30" x2="25" y2="5" stroke="#ef4444" stroke-width="3"/>
      <circle cx="25" cy="5" r="4" fill="#ef4444"/>
      <text x="25" y="-5" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" fill="#ef4444">i₃</text>
      <line x1="50" y1="55" x2="90" y2="55" stroke="url(#bondGrad)" stroke-width="4"/>
    </g>

    <!-- Ellipsis -->
    <text x="370" y="100" text-anchor="middle" font-family="system-ui, sans-serif" font-size="24" fill="#6b7280">···</text>

    <!-- Tensor A[n-1] -->
    <g transform="translate(400, 40)">
      <rect x="0" y="30" width="50" height="50" rx="8" fill="url(#tensorGrad)" stroke="#6d28d9" stroke-width="2"/>
      <text x="25" y="60" text-anchor="middle" font-family="system-ui, sans-serif" font-size="12" font-weight="bold" fill="white">A^{n-1}</text>
      <line x1="25" y1="30" x2="25" y2="5" stroke="#ef4444" stroke-width="3"/>
      <circle cx="25" cy="5" r="4" fill="#ef4444"/>
      <text x="25" y="-5" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" fill="#ef4444">i_{n-1}</text>
      <line x1="50" y1="55" x2="90" y2="55" stroke="url(#bondGrad)" stroke-width="4"/>
    </g>

    <!-- Tensor A[n] -->
    <g transform="translate(490, 40)">
      <rect x="0" y="30" width="50" height="50" rx="8" fill="url(#tensorGrad)" stroke="#6d28d9" stroke-width="2"/>
      <text x="25" y="60" text-anchor="middle" font-family="system-ui, sans-serif" font-size="14" font-weight="bold" fill="white">Aⁿ</text>
      <line x1="25" y1="30" x2="25" y2="5" stroke="#ef4444" stroke-width="3"/>
      <circle cx="25" cy="5" r="4" fill="#ef4444"/>
      <text x="25" y="-5" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" fill="#ef4444">iₙ</text>
    </g>

    <!-- Bond dimension labels -->
    <text x="135" y="145" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" fill="#0891b2">χ₁</text>
    <text x="225" y="145" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" fill="#0891b2">χ₂</text>
    <text x="315" y="145" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" fill="#0891b2">χ₃</text>
    <text x="455" y="145" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" fill="#0891b2">χ_{n-1}</text>
  </g>

  <!-- Formula -->
  <g transform="translate(50, 370)">
    <rect x="80" y="0" width="540" height="35" rx="5" fill="#f3f4f6" stroke="#d1d5db" stroke-width="1"/>
    <text x="350" y="23" text-anchor="middle" font-family="serif" font-size="13" fill="#374151">ψ_{i₁i₂...iₙ} = Σ_{α₁α₂...α_{n-1}} A^{[1]i₁}_{α₁} A^{[2]i₂}_{α₁α₂} A^{[3]i₃}_{α₂α₃} ··· A^{[n]iₙ}_{α_{n-1}}</text>
  </g>

  <!-- Legend -->
  <g transform="translate(50, 420)">
    <circle cx="10" cy="8" r="5" fill="#ef4444"/>
    <text x="22" y="12" font-family="system-ui, sans-serif" font-size="10" fill="#374151">Physical index (d=2 for qubits)</text>

    <line x1="160" y1="8" x2="190" y2="8" stroke="url(#bondGrad)" stroke-width="4"/>
    <text x="200" y="12" font-family="system-ui, sans-serif" font-size="10" fill="#374151">Virtual bond (dimension χ)</text>

    <rect x="360" y="0" width="20" height="16" rx="3" fill="url(#tensorGrad)"/>
    <text x="390" y="12" font-family="system-ui, sans-serif" font-size="10" fill="#374151">Site tensor: A^{[k]} has shape (χ_{k-1}, d, χ_k)</text>
  </g>

  <!-- Memory comparison -->
  <g transform="translate(620, 100)">
    <rect x="0" y="0" width="150" height="90" rx="8" fill="#ecfdf5" stroke="#10b981" stroke-width="2"/>
    <text x="75" y="20" text-anchor="middle" font-family="system-ui, sans-serif" font-size="11" font-weight="bold" fill="#059669">Memory Savings</text>
    <text x="75" y="40" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" fill="#374151">Full: O(2ⁿ)</text>
    <text x="75" y="55" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" fill="#374151">MPS: O(ndχ²)</text>
    <text x="75" y="75" text-anchor="middle" font-family="system-ui, sans-serif" font-size="9" fill="#6b7280">n=100, χ=64: 10⁵ vs 10³⁰</text>
  </g>
</svg>
